#!/bin/bash

echo "Installing Simplicity Commander"
CURRENT=$(pwd)
TMP="$CURRENT/simplicity-commander-tmp"
mkdir -p "$TMP"
cd "$TMP"
wget -c "https://www.silabs.com/documents/public/software/SimplicityCommander-Linux.zip"
unzip SimplicityCommander-Linux.zip
tar -xf SimplicityCommander-Linux/Commander_linux_*.tar.*
sudo mkdir /opt/silabs
sudo mv commander /opt/silabs/simplicity-commander

# Add icon
base64 -d <<EOF | dd status=none of="./simplicity-commander.png"
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
QmCC
EOF
sudo mv "./simplicity-commander.png" /opt/silabs/simplicity-commander/simplicity-commander.png

# Add desktop file
cat <<EOF | sudo dd status=none of="/usr/local/share/applications/simplicity-commander.desktop"
#!/usr/bin/env xdg-open
[Desktop Entry]
Name=Simplicity Commander
Exec=/opt/silabs/simplicity-commander/commander
Comment=Simplicity Commander
Terminal=false
Icon=/opt/silabs/simplicity-commander/simplicity-commander.png
Type=Application
Categories=Development;
Hidden=false
NoDisplay=false
StartupWMClass=commander
EOF

# Clean up
sudo chown -R root:root /opt/silabs/simplicity-commander
cd "$CURRENT"
rm -Rf "$TMP"
